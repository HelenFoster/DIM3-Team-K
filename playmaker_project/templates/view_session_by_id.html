{% extends 'layouts/base.html' %}
{% load staticfiles %}
{% block page_title %}View session{% endblock %}
{% block page_description %}View session details{% endblock %}
{% block extra_libraries %}
    <link href="{% static "css/chat.css" %}" rel="stylesheet" />
{% endblock %}
{% block content %}

    <h1>{{ session.sport }} Session</h1>
    <br />
    <div class="session-details">
        <div class="session-details-left">
            {% if session %}
                {{ session.id }}<br />
                {{ session.sport }}<br />
                {{ session.hostplayer }}<br />
                {{ session.guestplayer }}<br />
                {{ session.date }}<br />
                {{ session.time }}<br />
                {{ session.city }}<br />
                {{ session.location }}<br />
                {{ session.price }}<br />
                {{ session.details }}<br />
            {% else %}
                <strong>There was a problem retrieving session details.</strong>
            {% endif %}
        </div>
        <div class="session-details-right">
            <section class="module">
                <header class="top-bar">
                    <div class="left">
                        <span class="icon typicons-message"></span>
                        <h1>Ask the host</h1>
                    </div>
                </header>

                <ol class="discussion">
                    {% if messages|length == 0 %}
                        <p class="chat-no-messages">There are currently no messages in the chat.</p>
                    {% endif %}
                    {% for message in messages %}
                        {% if message.user_op == session.hostplayer %}
                            <li class="self">
                                {% else %}
                            <li class="other">
                        {% endif %}

                    <div class="avatar">
                        <!--<img src="https://scontent-a-lhr.xx.fbcdn.net/hphotos-frc1/t1.0-9/1011577_577934098937241_1737855916_n.jpg" />-->
                    </div>
                    <div class="messages">
                        <p>{{ message.message }}</p>
                        <p>It's a pretty small airport.</p>
                        <time>{{ message.user_op }} â€¢ {{ session.time }} {{ message.date }}</time>
                    </div>
                    </li>
                    {% endfor %}
                </ol>
                <div class="chat-message-wrapper">
                        <input type="text" placeholder="Leave a message..." class="chat-message form-control" />

                        <button type="button" class="btn btn-group-sm btn-primary chat-message-send">Send</button>

                </div>

            </section>
        </div>
    </div>
    <div class="clearfix"></div>

    <br>
    {% if host_viewing and not offer_accepted %}
        <h2>You have total of {{ offer_count }} offers from :</h2>
        {% for offer in offers %}
            <table>
                <tr>
                    <th>{{ offer.guest }}</th>
                    <td>
                        <form action="" method="POST">    <!-- USE A FUNCTION HERE TO ACCEPT THE OFFER-->
                            <input id="submit" type="button" value="Accept" />
                        </form>
                    </td>
                </tr>
            </table>
        {% endfor %}

    {% elif not host_viewing %}
        Number of offers for this session: {{ offer_count }}
    {% elif offer_accepted %}
        {{ session.hostplayer }} will play with {{ session.guestplayer }}
    {% endif %}

{% endblock %}